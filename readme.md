# 写到最前

这是我为自己的项目[xlsx_manager](https://github.com/xxjjtttt/xlsx_manager)用PyQt5套的一个壳
主要是为了方便一些同学更便捷的编辑json配置

---

# 写到最前

初学者正式开始写的第一个项目,代码都是一些基本的循环遍历与条件判断,
目前的想法就是实现了就行,大佬勿喷

**其实这个程序看上去是我闲得蛋疼,
说我完完全全可以用Excel的查找功能直接提取数据,
直接进行计数操作,何必用这么麻烦再写一个程序,
而且你这个程序很难用.**

但也不完全是,我遇到了一个很逗比的任务:就是统计学校内同学们的学习情况,
同学们有些数据没有按照要求填写,写的五花八门的,再加上数据量超级大,
这时,我写这个程序就显得很有必要了,
---

# 项目介绍

## 缺点

- **这个程序最难用的就是在于需要自己建立一个数据库(数据表单),程序只会依据这个数据库来做分析.**
- 这个程序基于openpyxl模块开发,只支持输入xlsx表格文件

## 推荐使用的对象

由于上述缺点,这个程序仅推荐用在复合以下条件的场景

1. 数据检查条件不会经常变动
2. 待处理的数据量大
3. 源数据以Excel表格为载体并愿意将其更改为xlsx格式文件
4. 期望输出格式为xlsx格式文件

## 功能

- 对数据库中的`同类数据`进行分类
- 对数据库中的`同类数据`进行计数

### 使用时注意事项

- 数据库以`B2`单元格为起点,表格中第一行与第一列都是需要空着或者填写表头,以便于使用者维护数据库
- 可以设置两个用于不同功能的数据库,也可以将他们合并为一个数据库,在使用之前记得设置好他们的`active_sheet`
- 固定好工作表的顺序以及他们的名称
- 名称在有需求更改时需要将工作环境下的所有位置的旧名称改为新名称
- 数据库在两个有效数据单元格之间不要留空白,因为这会导致后面的数据被"短路",导致最终得到的结果有误
- 计数功能是依据分类后的结果进行计数,所以如需计数请先进行分类操作,并将源文件设置为分类输出的文件
- 计数功能输出的是数据库中的第一列的表头,但是需要注意的是这个表头不会被记为有效的比对数据,仅用作建表的标准
-

---

# 项目配置

## Database

### 属性

#### path

- 程序将要读入的数据库的绝对路径 (包含文件名及其后缀名 ->`{{文件名}}.xlsx`)

## Sourcefile

### 属性

#### path

- 程序将要读入的源文件的绝对路径 (包含文件名及其后缀名 ->`{{文件名}}.xlsx`)

#### key_column

- `0` 没有关键值 (一般不会填写,因为数据分类怎么都会有一个分类的依据)
- `其他非0的值` (有效值)

#### index_column

- `0` (没有序号列)
- `其他非0的值` (数据分类,清洁之后会把有效的数据行依据指定位置进行依次排序)

#### have_header

- `true` (第一行有表头,程序会跳过第一行数据从第二行进行数据分类)
- `false` (第一行无表头)

## Targetfile

### 属性

#### path

- 程序将要输出的文件绝对路径 (包含文件名及其后缀名 ->`{{文件名}}.xlsx`)

#### key_column

- `0` 没有关键值 (一般不会填写,因为数据分类怎么都会有一个分类的依据)
- `其他非0的值` (有效值)

#### index_column

- `0` (没有序号列)
- `其他非0的值` (数据分类之后会把有效的数据行依据指定位置进行依次排序)

## 配置示例

### 用于分类的配置文件

``` json
{
    "task": {
        "file": {
            "database": {
                "path": "C:/Users/Administrator/Desktop/{{database}}.xlsx"
            },
            "sourcefile": {
                "path": "C:/Users/Administrator/Desktop/{{sourcefile}}.xlsx",
                "key_column": 4,
                "index_column": 1,
                "have_header": true
            },
            "targetfile": {
                "path": "C:/Users/Administrator/Desktop/{{targetfile}}.xlsx",
                "headers": [
                    "七年一班",
                    "七年二班",
                    "...",
                    "七年八班"
                ]
            }
        }
    }
}
```

### 用于计数的配置文件

```json
{
    "task": {
        "file": {
            "database": {
                "path": "C:/Users/Administrator/Desktop/数据表单.xlsx",
                "active_sheet": [2,3,4,5,6,7,8,9]
            },
            "sourcefile": {
                "path": "C:/Users/Administrator/Desktop/2024-01-15_湖北师范大学文理学院.xlsx",
                "key_column": 4,
                "index_column": 1,
                "have_header": true,
                "active_sheet": [1,2,3,4,5,6,7,8]
            },
            "targetfile": {
                "path": "",
                "headers": [
                    "七年一班",
                    "七年二班",
                    "...",
                    "七年八班"
                ]
            }
        }
    }
}
```

